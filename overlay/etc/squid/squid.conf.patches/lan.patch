Adds access control lists which differentiate between
LAN and non-LAN IP-adresses as well as between the
to-localhost and from-localhost packet flow direction.

Index: squid/squid.conf
===================================================================
--- squid.orig/squid.conf
+++ squid/squid.conf
@@ -599,7 +599,16 @@
 acl all src all
 acl manager proto cache_object
 acl localhost src 127.0.0.1/32
+acl from_localhost src 127.0.0.1/32
 acl to_localhost dst 127.0.0.0/8
+acl to_lan dst 192.168.0.0/16
+acl to_lan dst 10.0.0.0/8
+acl to_lan dst 172.16.0.0/12
+acl to_lan dst 169.254.0.0/16
+acl from_lan src 192.168.0.0/16
+acl from_lan src 10.0.0.0/8
+acl from_lan src 172.16.0.0/12
+acl from_lan src 169.254.0.0/16
 #
 # Example rule allowing access from your local networks.
 # Adapt to list your (internal) IP networks from where browsing
@@ -647,10 +656,13 @@ acl CONNECT method CONNECT
 #Recommended minimum configuration:
 #
 # Only allow cachemgr access from localhost
-http_access allow manager localhost
+#http_access allow manager localhost
+http_access allow manager from_localhost
+http_access allow ssh_ports
 http_access deny manager
 # Only allow purge requests from localhost
-http_access allow purge localhost
+#http_access allow purge localhost
+http_access allow purge from_localhost
 http_access deny purge
 # Deny requests to unknown ports
 http_access deny !Safe_ports
@@ -661,16 +673,19 @@ http_access deny CONNECT !SSL_ports
 # web applications running on the proxy server who think the only
 # one who can access services on "localhost" is a local user
 #http_access deny to_localhost
+http_access deny to_localhost
 #
 # INSERT YOUR OWN RULE(S) HERE TO ALLOW ACCESS FROM YOUR CLIENTS
 
 # Example rule allowing access from your local networks.
 # Adapt localnet in the ACL section to list your (internal) IP networks
 # from where browsing should be allowed
-http_access allow localnet
+#http_access allow localnet
 
 # Allow the localhost to have access by default
-http_access allow localhost
+#http_access allow localhost
+http_access allow from_localhost
+http_access allow from_lan
 
 # And finally deny all other access to this proxy
 http_access deny all
@@ -4346,6 +4361,7 @@ broken_vary_encoding allow apache
 #
 #Default:
 # none
+always_direct allow from_localhost to_localhost
 
 #  TAG: never_direct
 #	Usage: never_direct allow|deny [!]aclname ...
